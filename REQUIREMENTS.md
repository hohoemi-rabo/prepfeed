# YouTubeスコープ 要件定義書

## 1. サービス概要

### 1.1 基本情報

- **サービス名**: YouTubeスコープ
- **旧サービス名**: チャンネルスコープ（Phase 5で名称変更）
- **英語表記**: YouTubeScope
- **キャッチコピー**: 配信者のための無料分析ツール
- **サービス説明**: YouTube チャンネル分析とキーワード検索による動画企画支援を提供する、シンプルで使いやすい分析サービス

### 1.2 ターゲットユーザー

- 個人配信者（初心者〜中堅）
- 競合チャンネルをリサーチしたい配信者
- チャンネルの成長を客観的に把握したい配信者
- **[Phase 5追加]** 動画企画を考える配信者・クリエイター
- **[Phase 5追加]** トレンドキーワードをリサーチしたい配信者

### 1.3 提供価値

- ログイン不要で即座に分析開始
- 直感的な UI で誰でも簡単に使える
- 完全無料で全機能を利用可能
- **[Phase 5追加]** キーワードから人気動画を発見し、企画のヒントを得られる
- **[Phase 5追加]** 人気動画のタグ分析で、効果的なタグ戦略を立てられる

## 2. 機能要件

### 2.1 チャンネル検索機能

#### 検索フロー

1. トップページの検索ボックスにチャンネル名を入力
2. 部分一致でチャンネル候補をリアルタイム表示
3. 候補から目的のチャンネルを選択
4. 分析結果ページへ遷移

#### 検索仕様

- **検索方式**: チャンネル名の部分一致検索
- **候補表示**: 最大 10 件まで表示
- **検索履歴**: 実装しない（MVP 版）

### 2.2 動画データ取得・表示

#### データ取得仕様

- **取得動画数**: 最新 50 本
- **更新頻度**: リアルタイム（API 直接呼び出し）
- **キャッシュ**: Vercel KV 使用、30 分間保持

#### 表示項目（動画ごと）

- 動画サムネイル（中サイズ：320x180px）
- 動画タイトル
- 再生数（カンマ区切り表示）
- いいね数
- コメント数
- 投稿日時
- 動画時間

### 2.3 分析機能

#### ソート機能

- **再生数順**（デフォルト）
- **投稿日順**（新しい順/古い順）
- **伸び率順**
- **コメント率順**
- **いいね率順**

#### 分析指標の計算式

```
伸び率スコア = 再生数 ÷ (公開からの日数 + 1)
コメント率 = (コメント数 ÷ 再生数) × 100
いいね率 = (いいね数 ÷ 再生数) × 100
```

#### 特別な表示

- 公開から 3 日以内の動画：「NEW」バッジを表示
- 伸び率が特に高い動画：「急上昇」バッジを表示

### 2.4 データ可視化

#### グラフ仕様

- **種類**: 折れ線グラフ（アニメーション付き）
- **データ**: 最新 10 本の動画の再生数推移
- **ライブラリ**: Recharts または Chart.js
- **デザイン**: グラデーション付きのモダンなスタイル
- **インタラクション**: ホバーで詳細表示

### 2.5 共有機能

#### SNS シェア

- X（Twitter）シェアボタン
- シェア時テキスト例：

  ```
  「[チャンネル名]」を分析しました！
  最高再生数：[数値]回

  #チャンネルスコープ
  [URL]
  ```

#### OGP 設定

- **画像サイズ**: 1200x630px
- **動的生成**: Vercel OG の`@vercel/og`を使用
- **表示内容**:
  - サービスロゴ
  - チャンネル名
  - 主要統計（総再生数、動画本数など）
  - キャッチコピー

### 2.6 キーワード検索機能 [Phase 5追加]

#### 機能概要

動画企画を考える配信者向けに、キーワードから人気動画を検索・分析できる機能。トレンドや人気のトピックを把握し、効果的な動画企画のヒントを提供する。

#### 検索フロー

1. トップページまたは専用ページで検索キーワードを入力
2. YouTube上の関連動画を再生数順で取得
3. キーワード検索結果ページへ遷移
4. ソート機能で様々な角度から分析

#### 検索仕様

- **検索方式**: YouTube検索API（`search.list`）
- **取得動画数**: 50本（既存のチャンネル分析と同じ）
- **デフォルトソート**: 再生数の多い順
- **期間フィルター**: 全期間（MVPでは固定、将来的に1週間/1ヶ月/1年など追加予定）
- **検索対象**: 動画のみ（type=video）

#### 表示項目

既存のVideoCardと同じ情報を表示:
- 動画サムネイル
- 動画タイトル
- チャンネル名（キーワード検索では複数チャンネルが混在）
- 再生数、いいね数、コメント数
- 投稿日、動画時間
- 伸び率、エンゲージメント率
- 「新着」「急上昇」バッジ

#### キーワード検索特有の追加情報

- **タグ表示**: 動画に設定されているタグを表示（企画のヒントに）
- **チャンネル情報**: 各動画のチャンネルへのリンク
- 将来的に追加予定:
  - カテゴリ表示
  - 関連度スコア（技術的に可能なら）

#### ソート機能

既存のSortTabsコンポーネントを再利用:
- 再生数順（デフォルト）
- 投稿日順（新しい順/古い順）
- 伸び率順
- コメント率順
- いいね率順

#### ページ構成

```
URL: /keyword/[query]

[ヘッダー]
- ロゴ（トップへのリンク）
- ナビゲーション

[検索結果ヘッダー]
- 検索キーワード表示: 「"[キーワード]" の検索結果」
- 検索結果件数: 「50件の動画を表示」
- 新しい検索ボタン

[ソートタブ]
- 再生数 | 投稿日 | 伸び率 | コメント率 | いいね率

[動画リスト]
- VideoCardコンポーネントを再利用
- タグ表示を追加
- 10件ずつ表示、「もっと見る」ボタンで追加読み込み

[フッター]
```

#### キャッシュ戦略

- **キャッシュ期間**: 30分（既存と同じ）
- **キャッシュキー**: `channel-scope:keyword-search:{query}`
- **理由**: 同じキーワードが複数回検索される可能性が高い

#### API クォータコスト

| API | コスト | 説明 |
|-----|--------|------|
| search.list | 100 units | キーワード検索（50件） |
| videos.list | 50 units | 動画詳細取得（50件、統計・タグ情報） |
| **合計** | **150 units** | 1回の検索あたり |

**1日の利用可能回数**: 10,000 units ÷ 150 units = **約66回**

チャンネル分析と併用する場合:
- チャンネル分析: 20回（4,000 units）
- キーワード検索: 40回（6,000 units）
- **合計: 10,000 units**

## 3. 非機能要件

### 3.1 パフォーマンス要件

- **ページロード時間**: 3 秒以内を目標
- **API 応答時間**: 2 秒以内
- **対応デバイス**: PC（50%）、モバイル（50%）
- **レスポンシブ対応**: 必須

### 3.2 セキュリティ要件

- YouTube Data API キーはサーバーサイドで管理
- 環境変数での管理（`YOUTUBE_API_KEY`）
- CORS 設定の適切な実装

### 3.3 制限事項対応

#### API 制限対応

- **制限**: 1 日 10,000 ユニット
- **対策**:
  - Vercel KV による 30 分キャッシュ
  - 同一 IP からの連続リクエスト制限（1 分間に 10 回まで）
  - 制限到達時のメッセージ表示

#### エラーハンドリング

| エラー種別         | 表示メッセージ                                                 |
| ------------------ | -------------------------------------------------------------- |
| チャンネル未検出   | 該当するチャンネルが見つかりません。再度確認してください。     |
| API 制限到達       | 現在アクセスが集中しています。5 分後に再度お試しください。     |
| ネットワークエラー | 通信エラーが発生しました。しばらくしてから再度お試しください。 |
| 削除/非公開動画    | 一部の動画は非公開または削除されているため表示できません。     |

## 4. UI/UX 設計

### 4.1 ページ構成

#### トップページ

```
[ヘッダー]
- ロゴ「チャンネルスコープ」
- キャッチコピー

[メインエリア]
- 大きな検索ボックス
- プレースホルダー「YouTubeチャンネル名を入力」
- 検索ボタン（虫眼鏡アイコン）

[フッター]
- 免責事項リンク
- © 2024 チャンネルスコープ
```

#### 分析結果ページ

```
[ヘッダー]
- ロゴ（トップへのリンク）
- 新規検索ボタン

[チャンネル情報]
- チャンネル名
- チャンネルアイコン
- 登録者数

[グラフエリア]
- 最新10本の再生数推移グラフ

[ソートタブ]
- 再生数 | 投稿日 | 伸び率 | コメント率 | いいね率

[動画リスト]
- サムネイル | タイトル | 統計情報
- 無限スクロール or ページネーション

[シェアボタン]
- Xでシェア
```

### 4.2 デザイン仕様

- **カラーテーマ**:
  - プライマリ: #FF0000（YouTube 風レッド）
  - セカンダリ: #282828（ダークグレー）
  - アクセント: #00D4FF（シアン）
- **フォント**: Noto Sans JP
- **アニメーション**: Framer Motion 使用
- **アイコン**: Heroicons / Lucide React

## 5. 技術仕様

### 5.1 技術スタック

| 項目           | 技術                       | バージョン |
| -------------- | -------------------------- | ---------- |
| フレームワーク | Next.js (App Router)       | 15.x       |
| 言語           | TypeScript                 | 5.x        |
| スタイリング   | Tailwind CSS + CSS Modules | 3.4.17     |
| アニメーション | Framer Motion              | 11         |
| 状態管理       | Zustand                    | 4          |
| グラフ         | Recharts                   | 最新       |
| アイコン       | Lucide React               | 最新       |
| キャッシュ     | Vercel KV                  | -          |
| OGP 画像生成   | @vercel/og                 | 最新       |
| 分析           | Vercel Analytics           | -          |
| デプロイ       | Vercel                     | -          |

### 5.2 ディレクトリ構造

```
channelscope/
├── app/
│   ├── layout.tsx
│   ├── page.tsx
│   ├── channel/
│   │   └── [id]/
│   │       └── page.tsx
│   ├── api/
│   │   ├── youtube/
│   │   │   ├── search/
│   │   │   │   └── route.ts
│   │   │   └── channel/
│   │   │       └── [id]/
│   │   │           └── route.ts
│   │   └── og/
│   │       └── route.tsx
│   └── globals.css
├── components/
│   ├── SearchBar.tsx
│   ├── ChannelCard.tsx
│   ├── VideoList.tsx
│   ├── VideoCard.tsx
│   ├── Chart.tsx
│   └── ShareButton.tsx
├── lib/
│   ├── youtube.ts
│   ├── cache.ts
│   └── utils.ts
├── types/
│   └── index.ts
└── public/
    └── logo.svg
```

### 5.3 API 設計

#### YouTube Data API v3 使用エンドポイント

1. **チャンネル検索**: `/search`

   - パラメータ: `q`, `type=channel`, `maxResults=10`
   - 消費ユニット: 100

2. **チャンネル詳細**: `/channels`

   - パラメータ: `id`, `part=snippet,statistics`
   - 消費ユニット: 3

3. **動画リスト取得**: `/search`

   - パラメータ: `channelId`, `order=date`, `maxResults=50`
   - 消費ユニット: 100

4. **動画詳細**: `/videos`
   - パラメータ: `id`, `part=statistics,contentDetails`
   - 消費ユニット: 3

#### 内部 API 設計

```typescript
// /api/youtube/search
GET /api/youtube/search?q={query}
Response: {
  channels: [{
    id: string,
    title: string,
    thumbnail: string,
    subscriberCount: number
  }]
}

// /api/youtube/channel/[id]
GET /api/youtube/channel/{channelId}
Response: {
  channel: {...},
  videos: [{
    id: string,
    title: string,
    thumbnail: string,
    viewCount: number,
    likeCount: number,
    commentCount: number,
    publishedAt: string,
    duration: string
  }]
}
```

## 6. 実装優先順位

### Phase 1: MVP（1 週間）

1. 基本的な UI 構築
2. YouTube API 連携
3. チャンネル検索・表示
4. 動画リスト表示
5. 基本的なソート機能

### Phase 2: 分析機能（3 日）

1. 伸び率計算の実装
2. グラフ表示
3. 各種ソート機能の完成
4. バッジ表示機能

### Phase 3: 最適化（3 日）

1. Vercel KV キャッシュ実装
2. OGP 画像動的生成
3. SNS シェア機能
4. エラーハンドリング強化
5. パフォーマンス最適化

### Phase 4: 公開準備（1 日）

1. 免責事項ページ作成
2. Vercel Analytics 設定
3. 本番環境デプロイ
4. 動作確認

### Phase 5: キーワード検索機能追加（1 週間） [新機能]

#### プロジェクト名変更（1 日）
1. サービス名を「チャンネルスコープ」→「YouTubeスコープ」に変更
2. ロゴ、ファビコン、OGP画像の更新
3. README、ドキュメント、フッター等の全文言更新
4. GitHub リポジトリ名の変更（オプション）

#### キーワード検索API実装（2 日）
1. `/api/youtube/keyword/route.ts` 作成
2. YouTube search.list API統合
3. videos.list APIでタグ情報取得
4. キャッシュ実装（30分TTL）
5. エラーハンドリング
6. レート制限の確認・調整

#### キーワード検索ページUI実装（2 日）
1. `/keyword/[query]/page.tsx` 作成
2. 検索結果ヘッダーコンポーネント
3. VideoCardにタグ表示を追加
4. 既存SortTabsコンポーネントの再利用
5. VideoListコンポーネントの再利用
6. レスポンシブデザイン対応

#### ホームページ更新（1 日）
1. 2つの検索機能を明確に区別（タブまたはカード）
2. 「チャンネル検索」「キーワード検索」のUI設計
3. 各検索機能の説明文追加
4. デザイン調整

#### テスト・デバッグ（1 日）
1. 機能テスト（検索、ソート、タグ表示）
2. API クォータ使用量の確認
3. エラーケースのテスト
4. パフォーマンステスト
5. クロスブラウザテスト
6. ドキュメント更新（CLAUDE.md、REQUIREMENTS.md）

## 7. 運用・保守

### 7.1 監視項目

- API 使用量（日次）
- エラー発生率
- ページロード時間
- ユーザーアクセス数

### 7.2 免責事項

```
【免責事項】
・本サービスはYouTubeの公開データを利用した参考値を提供します
・本サービスはYouTube及びGoogle LLCと提携していません
・データの正確性・完全性は保証いたしません
・分析結果は参考情報としてご利用ください
```

### 7.3 将来の拡張案

**チャンネル分析機能:**
- お気に入りチャンネル登録機能
- 複数チャンネル比較
- 急上昇予測 AI
- CSV 出力機能
- 通知機能（動画急上昇アラート）

**キーワード検索機能:**
- 期間フィルター追加（1週間、1ヶ月、1年）
- カテゴリ表示
- 複数キーワードの比較分析
- トレンドキーワード自動提案
- タグクラウド表示
- キーワード検索履歴
- 人気タグランキング

**共通機能:**
- ユーザーアカウント機能（履歴保存）
- エクスポート機能（PDF、CSV）
- カスタムレポート生成

## 8. リスク管理

| リスク           | 影響度 | 対策                       |
| ---------------- | ------ | -------------------------- |
| API 制限到達     | 高     | キャッシュ強化、使用量監視 |
| YouTube 仕様変更 | 中     | API 更新の定期確認         |
| 不適切な利用     | 低     | 利用規約明記、レート制限   |
| サーバー負荷     | 中     | Vercel 自動スケーリング    |

---

**作成日**: 2025 年 09 月
**バージョン**: 1.0.0
